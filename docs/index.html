---

title: FastAI XLA Extensions Library


keywords: fastai
sidebar: home_sidebar

summary: "The FastAI XLA Extensions library package allows your fastai/Pytorch models to run on TPUs using the Pytorch-XLA library."
description: "The FastAI XLA Extensions library package allows your fastai/Pytorch models to run on TPUs using the Pytorch-XLA library."
nb_path: "nbs/index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://colab.research.google.com/github/butchland/fastai_xla_extensions/blob/master/nbs/index.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Documentation-Site">Documentation Site<a class="anchor-link" href="#Documentation-Site"> </a></h2><p>You can view the documentation here: <a href="https://butchland.github.io/fastai_xla_extensions">https://butchland.github.io/fastai_xla_extensions</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install fastai_xla_extensions</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Configure-TPU-Environment-Access">Configure TPU Environment Access<a class="anchor-link" href="#Configure-TPU-Environment-Access"> </a></h3><p>The Pytorch XLA package requires an environment supporting TPUs (Kaggle kernels, GCP or Colab environments required).</p>
<p>Nominally, Pytorch XLA also supports  GPUs so please see the <a href="https://pytorch.org/xla/release/1.7/index.html">Pytorch XLA site for more instructions</a>.</p>
<p>If running on Colab, make sure the Runtime Type is set to TPU.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Install-pytorch-1.7.1">Install pytorch 1.7.1<a class="anchor-link" href="#Install-pytorch-1.7.1"> </a></h3><p>Use pytorch 1.7.1 as this is latest version of pytorch supported by the fastai package</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#colab</span>
<span class="c1"># install pytorch 1.7.1 b/c fastai doesn&#39;t support pytorch 1.8 just yet</span>
<span class="o">!</span>pip install -Uqq --no-cache-dir <span class="nv">torch</span><span class="o">==</span><span class="m">1</span>.7.1+cu101 <span class="nv">torchvision</span><span class="o">==</span><span class="m">0</span>.8.2+cu101 <span class="nv">torchtext</span><span class="o">==</span><span class="m">0</span>.8.0 -f https://download.pytorch.org/whl/torch_stable.html
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Install-fastai">Install fastai<a class="anchor-link" href="#Install-fastai"> </a></h3><p>Use the latest fastai and fastcore versions</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#colab</span>
<span class="o">!</span>pip install -Uqq fastcore --upgrade
<span class="o">!</span>pip install -Uqq fastai --upgrade
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Install-Pytorch-XLA">Install Pytorch XLA<a class="anchor-link" href="#Install-Pytorch-XLA"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the official way to install Pytorch-XLA 1.7 as per the <a href="https://colab.research.google.com/github/pytorch/xla/blob/master/contrib/colab/getting-started.ipynb#scrollTo=CHzziBW5AoZH">instructions here</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#colab</span>
<span class="o">!</span>pip install -Uqq cloud-tpu-client<span class="o">==</span><span class="m">0</span>.10 https://storage.googleapis.com/tpu-pytorch/wheels/torch_xla-1.7-cp37-cp37m-linux_x86_64.whl
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Check-if-XLA-is-available">Check if XLA is available<a class="anchor-link" href="#Check-if-XLA-is-available"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">torch_xla</span>
<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;TPU environment not available&#39;</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>WARNING:root:Waiting for TPU to be start up with version pytorch-1.7...
WARNING:root:Waiting for TPU to be start up with version pytorch-1.7...
WARNING:root:TPU has started up successfully with version pytorch-1.7
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Import-the-libraries">Import the libraries<a class="anchor-link" href="#Import-the-libraries"> </a></h3><p>Import the fastai and fastai_xla_extensions libraries</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#hide_output</span>
<span class="kn">from</span> <span class="nn">fastai_xla_extensions.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Single-and-Multi-Core-TPU-Modes">Single and Multi Core TPU Modes<a class="anchor-link" href="#Single-and-Multi-Core-TPU-Modes"> </a></h2><p>The <code>fastai_xla_extensions</code> package allows you to train your models using either a single TPU core or multiple TPU cores.</p>
<p>Using multi TPU cores is usually faster than single TPU core, but due to some limitations, not all fastai features are supported in multi TPU core mode.</p>
<ul>
<li><p><strong>Multi Core TPU mode</strong></p>
<p>In order to run in multi TPU core mode, the <code>fastai_xla_extensions</code> package patched some additional methods to the <code>Learner</code> class.</p>
<p>These additional methods are all prefixed by <code>xla</code>. For example, to run the <code>Learner.fit</code> method in multi core tpu mode, you can invoke the equivalent <a href="/fastai_xla_extensions/multi_core.learner.html#Learner.xla_fit"><code>Learner.xla_fit</code></a> method, with almost the same parameters.</p>
</li>
</ul>
<p>Note that in multi core TPU mode, when calling normal learner or data loader methods (not prefixed by <code>xla</code>), the process does not use the multi core TPUs, but instead runs them using the CPU.</p>
<ul>
<li><p><strong>List of <code>xla</code> prefixed methods</strong></p>
<ul>
<li>xla_fit</li>
<li>xla_fine_tune</li>
<li>xla_fit_one_cycle</li>
<li>xla_fit_sgdr</li>
<li>xla_fit_flat_cos</li>
<li>xla_lr_find</li>
<li>xla_get_preds</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>Additional <code>xla</code> Parameters (for Multi Core TPU mode)</strong></p>
<p>All <code>xla</code> prefixed methods support the following additional parameters:</p>
<ul>
<li><p>num_cores: this is defaulted to 8 (representing the number of TPU cores per TPU device) - valid values are <code>8</code> or <code>1</code> on Google Colab. For running GCP TPUs, other values maybe possible. See the <a href="https://pytorch.org/xla/release/1.7/index.html">Pytorch XLA page</a> for more details.</p>
</li>
<li><p>start_method: this is defaulted to <code>fork</code> which the only value supported on Google Colab. On GCP, other values supported include <code>spawn</code>. Again, see the <a href="https://pytorch.org/xla/release/1.7/index.html">Pytorch XLA page</a> for more details.</p>
</li>
<li><p>master_cbs: these are callbacks that are run only on the master ordinal process (rank = 0). This allows the addition of callbacks that may interfere with each other if run simultaneously on more than one process by restricting them to run on only one process - the master ordinal process.</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>Single Core TPU mode</strong></p>
<p>In order to run in single TPU core mode, the <code>fastai_xla_extensions</code> package added a method <code>to_xla</code> to the <code>Learner</code> class.</p>
<p>After invoking this method, the learner will now use an associated TPU core device to the learner process which will be used when training the model.</p>
<p>This means we can use the same <code>fit</code> methods in <code>Learner</code> that we normally use to train the model when using a GPU or a CPU.</p>
<p>Also note that the single TPU core mode is incompatible with the Multi TPU Core mode, and that the kernel will have to restarted once the single TPU core mode is set. This is because once a TPU core is associated with the main process, it cannot be unset without restarting the kernel.</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multi-TPU-Core-Example">Multi TPU Core Example<a class="anchor-link" href="#Multi-TPU-Core-Example"> </a></h3><p>Build a MNIST classifier -- adapted from fastai course <a href="https://github.com/fastai/course-v4/blob/master/nbs/04_mnist_basics.ipynb">Lesson 4 notebook</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load MNIST dataset</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create Fastai DataBlock</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datablock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span>
    <span class="n">blocks</span><span class="o">=</span><span class="p">(</span><span class="n">ImageBlock</span><span class="p">,</span><span class="n">CategoryBlock</span><span class="p">),</span>
    <span class="n">get_items</span><span class="o">=</span><span class="n">get_image_files</span><span class="p">,</span>
    <span class="n">splitter</span><span class="o">=</span><span class="n">GrandparentSplitter</span><span class="p">(),</span>
    <span class="n">get_y</span><span class="o">=</span><span class="n">parent_label</span><span class="p">,</span>
    <span class="n">item_tfms</span><span class="o">=</span><span class="n">Resize</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span>
    <span class="c1"># batch transforms run on the CPU and are slow, so only using the Normalize batch transform</span>
    <span class="n">batch_tfms</span><span class="o">=</span><span class="p">[</span><span class="n">Normalize</span><span class="o">.</span><span class="n">from_stats</span><span class="p">(</span><span class="o">*</span><span class="n">imagenet_stats</span><span class="p">)]</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datablock</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Setting-up type transforms pipelines
Collecting items from /root/.fastai/data/mnist_tiny
Found 1428 items
2 datasets of sizes 709,699
Setting up Pipeline: PILBase.create
Setting up Pipeline: parent_label -&gt; Categorize -- {&#39;vocab&#39;: None, &#39;sort&#39;: True, &#39;add_na&#39;: False}

Building one sample
  Pipeline: PILBase.create
    starting from
      /root/.fastai/data/mnist_tiny/train/7/8791.png
    applying PILBase.create gives
      PILImage mode=RGB size=28x28
  Pipeline: parent_label -&gt; Categorize -- {&#39;vocab&#39;: None, &#39;sort&#39;: True, &#39;add_na&#39;: False}
    starting from
      /root/.fastai/data/mnist_tiny/train/7/8791.png
    applying parent_label gives
      7
    applying Categorize -- {&#39;vocab&#39;: None, &#39;sort&#39;: True, &#39;add_na&#39;: False} gives
      TensorCategory(1)

Final sample: (PILImage mode=RGB size=28x28, TensorCategory(1))


Collecting items from /root/.fastai/data/mnist_tiny
Found 1428 items
2 datasets of sizes 709,699
Setting up Pipeline: PILBase.create
Setting up Pipeline: parent_label -&gt; Categorize -- {&#39;vocab&#39;: None, &#39;sort&#39;: True, &#39;add_na&#39;: False}
Setting up after_item: Pipeline: Resize -- {&#39;size&#39;: (28, 28), &#39;method&#39;: &#39;crop&#39;, &#39;pad_mode&#39;: &#39;reflection&#39;, &#39;resamples&#39;: (2, 0), &#39;p&#39;: 1.0} -&gt; ToTensor
Setting up before_batch: Pipeline: 
Setting up after_batch: Pipeline: IntToFloatTensor -- {&#39;div&#39;: 255.0, &#39;div_mask&#39;: 1} -&gt; Normalize -- {&#39;mean&#39;: tensor([[[[0.4850]],

         [[0.4560]],

         [[0.4060]]]]), &#39;std&#39;: tensor([[[[0.2290]],

         [[0.2240]],

         [[0.2250]]]]), &#39;axes&#39;: (0, 2, 3)}

Building one batch
Applying item_tfms to the first sample:
  Pipeline: Resize -- {&#39;size&#39;: (28, 28), &#39;method&#39;: &#39;crop&#39;, &#39;pad_mode&#39;: &#39;reflection&#39;, &#39;resamples&#39;: (2, 0), &#39;p&#39;: 1.0} -&gt; ToTensor
    starting from
      (PILImage mode=RGB size=28x28, TensorCategory(1))
    applying Resize -- {&#39;size&#39;: (28, 28), &#39;method&#39;: &#39;crop&#39;, &#39;pad_mode&#39;: &#39;reflection&#39;, &#39;resamples&#39;: (2, 0), &#39;p&#39;: 1.0} gives
      (PILImage mode=RGB size=28x28, TensorCategory(1))
    applying ToTensor gives
      (TensorImage of size 3x28x28, TensorCategory(1))

Adding the next 3 samples

No before_batch transform to apply

Collating items in a batch

Applying batch_tfms to the batch built
  Pipeline: IntToFloatTensor -- {&#39;div&#39;: 255.0, &#39;div_mask&#39;: 1} -&gt; Normalize -- {&#39;mean&#39;: tensor([[[[0.4850]],

         [[0.4560]],

         [[0.4060]]]]), &#39;std&#39;: tensor([[[[0.2290]],

         [[0.2240]],

         [[0.2250]]]]), &#39;axes&#39;: (0, 2, 3)}
    starting from
      (TensorImage of size 4x3x28x28, TensorCategory([1, 1, 1, 1]))
    applying IntToFloatTensor -- {&#39;div&#39;: 255.0, &#39;div_mask&#39;: 1} gives
      (TensorImage of size 4x3x28x28, TensorCategory([1, 1, 1, 1]))
    applying Normalize -- {&#39;mean&#39;: tensor([[[[0.4850]],

         [[0.4560]],

         [[0.4060]]]]), &#39;std&#39;: tensor([[[[0.2290]],

         [[0.2240]],

         [[0.2250]]]]), &#39;axes&#39;: (0, 2, 3)} gives
      (TensorImage of size 4x3x28x28, TensorCategory([1, 1, 1, 1]))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create the dataloader</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">datablock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="c1"># use a small batch size as mnist_tiny dataset is very small</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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2O5m6CrvzDPPDNkXv/jFkOUGpceNG5e95m9/+9uQ5d733nrrrZCNGDEiZI888kj2PrlhrB133ilkd9x+e/b8dmDoCgCAtqVhBQCgaBpWAACKpmEFAKBoGlYAAIrWZ78lYNCgQSH73ZK4rVnuuI48+tijITvttNNCNmvWrJBdf/312WtO2GVCyA779GEhu+SSSxopsUh9ZdJ6+PDhIbv77jkhGzlyVMPXbIfp/VbfJ7fN4Prrr9/UNRvVV9ZuO1t99dVD9l/Px20vH3/ssZDtv//+2WsuWLAgZLlp7SOOOCJkkyZNCtnoTUZn77P0taUh23vvvUN25513Zs9vRn//loDct+2klNL9990fstffeD1kEydODNmcOfH9vllrr712yB7LrOWUUlpv3fVC5lsCAACgEBpWAACKpmEFAKBoGlYAAIo2sNUF9JTcMNnzC+MH9Tty7LHHhuyaa64JWW6rtZw77rgjm+eGrihTbvu93LahN98Ut4gcNmxYU/e+9tprQ3bdddc1fH5Vxc+x535G9tprr5Dlhg96U7O/d5RnvfXi8EhKKV166aUhe/e73x2yFxYtCtmOO+4Ystdee63hmhZlrnnSSSc1lN18883Za+68084hW3nllRuuia774Ac+mM1/ff+vQ7bPPvuE7MUX89v6drfcYGBuuApPWAEAKJyGFQCAomlYAQAomoYVAICi9dmhqzfeeCNko0fndyPpDdtvv33Dx77+etx1gzI9+MADIeutXZg645BDDgnZOuusE7LcLjydkdvpqlG5HeJSSumcb3+7y9ek9Y488siQ/eu//mv22E023qSha247fruQdWbAqhm5/z/bfHib7LFnnX1WyGbPnt3tNRFdccUV2fzKK68MWW/9O/c9m24astwQX0cuv+LykP3H3Xc3U1Jb8YQVAICiaVgBACiahhUAgKJpWAEAKFqV2+3mby9WVccv0qFVVlklZPfdd1/22CFDhoQsNxzW6I5aJarrOm6z1MP6w9odt+WW2fz/nn12yHJDf8uXL+/2mnJDVwsXLgxZbvDh+OOPz14zN0DZW6zdzrn11ltDtsP2OzR8/p+W/ilkuSGnGTNmdKqursr9jF354x+HbOjQodnzN99885AtWbKk+cIa0Ntrt53XbU8YNGhQyGbOnBmyj330YyF75tm52WuOHx/fx3Pvr+1sRevWE1YAAIqm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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create a Fastai CNN Learner</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span> <span class="o">=</span> <span class="n">cnn_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">resnet18</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">concat_pool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># fastai AdaptivePooling causes a lowering which slows down the training so using nn.AvgPool2D</span>
                      
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Downloading: &#34;https://download.pytorch.org/models/resnet18-5c106cde.pth&#34; to /root/.cache/torch/hub/checkpoints/resnet18-5c106cde.pth
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the <code>lr_find</code> works</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">xla_lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start fit
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=7.585775847473997e-08, lr_steep=6.309573450380412e-07)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Run one cycle training.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">xla_fit_one_cycle</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">lr_max</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span><span class="mf">0.02</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start fit
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.190064</td>
      <td>0.391755</td>
      <td>0.848011</td>
      <td>00:17</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.273210</td>
      <td>0.288629</td>
      <td>0.882102</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.322163</td>
      <td>0.430995</td>
      <td>0.875000</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.354422</td>
      <td>0.534526</td>
      <td>0.830966</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.372328</td>
      <td>0.517053</td>
      <td>0.833807</td>
      <td>00:06</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Further fine-tuning</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">xla_fit_one_cycle</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">lr_max</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">7e-4</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start fit
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.046700</td>
      <td>0.451159</td>
      <td>0.867898</td>
      <td>00:14</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.056459</td>
      <td>0.340751</td>
      <td>0.896307</td>
      <td>00:07</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.061811</td>
      <td>0.376011</td>
      <td>0.892045</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.071214</td>
      <td>0.394541</td>
      <td>0.879261</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.137522</td>
      <td>0.407396</td>
      <td>0.899148</td>
      <td>00:06</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Model params are using CPU (since it is the spawned process models that are moved to TPU)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">one_param</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">device</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>device(type=&#39;cpu&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Plot loss seems to be working fine.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Single-TPU-Core-Example">Single TPU Core Example<a class="anchor-link" href="#Single-TPU-Core-Example"> </a></h3><p>Build a MNIST classifier -- adapted from fastai course <a href="https://github.com/fastai/course-v4/blob/master/nbs/04_mnist_basics.ipynb">Lesson 4 notebook</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load MNIST dataset</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create Fastai DataBlock</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datablock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span>
    <span class="n">blocks</span><span class="o">=</span><span class="p">(</span><span class="n">ImageBlock</span><span class="p">,</span><span class="n">CategoryBlock</span><span class="p">),</span>
    <span class="n">get_items</span><span class="o">=</span><span class="n">get_image_files</span><span class="p">,</span>
    <span class="n">splitter</span><span class="o">=</span><span class="n">GrandparentSplitter</span><span class="p">(),</span>
    <span class="n">get_y</span><span class="o">=</span><span class="n">parent_label</span><span class="p">,</span>
    <span class="n">item_tfms</span><span class="o">=</span><span class="n">Resize</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span>
    <span class="c1"># affine transforms are performed on the CPU, other batch transforms are done on the TPU</span>
    <span class="n">batch_tfms</span><span class="o">=</span><span class="n">aug_transforms</span><span class="p">(</span><span class="n">do_flip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">min_scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datablock</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Setting-up type transforms pipelines
Collecting items from /root/.fastai/data/mnist_tiny
Found 1428 items
2 datasets of sizes 709,699
Setting up Pipeline: PILBase.create
Setting up Pipeline: parent_label -&gt; Categorize -- {&#39;vocab&#39;: None, &#39;sort&#39;: True, &#39;add_na&#39;: False}

Building one sample
  Pipeline: PILBase.create
    starting from
      /root/.fastai/data/mnist_tiny/train/7/8791.png
    applying PILBase.create gives
      PILImage mode=RGB size=28x28
  Pipeline: parent_label -&gt; Categorize -- {&#39;vocab&#39;: None, &#39;sort&#39;: True, &#39;add_na&#39;: False}
    starting from
      /root/.fastai/data/mnist_tiny/train/7/8791.png
    applying parent_label gives
      7
    applying Categorize -- {&#39;vocab&#39;: None, &#39;sort&#39;: True, &#39;add_na&#39;: False} gives
      TensorCategory(1)

Final sample: (PILImage mode=RGB size=28x28, TensorCategory(1))


Collecting items from /root/.fastai/data/mnist_tiny
Found 1428 items
2 datasets of sizes 709,699
Setting up Pipeline: PILBase.create
Setting up Pipeline: parent_label -&gt; Categorize -- {&#39;vocab&#39;: None, &#39;sort&#39;: True, &#39;add_na&#39;: False}
Setting up after_item: Pipeline: Resize -- {&#39;size&#39;: (28, 28), &#39;method&#39;: &#39;crop&#39;, &#39;pad_mode&#39;: &#39;reflection&#39;, &#39;resamples&#39;: (2, 0), &#39;p&#39;: 1.0} -&gt; ToTensor
Setting up before_batch: Pipeline: 
Setting up after_batch: Pipeline: IntToFloatTensor -- {&#39;div&#39;: 255.0, &#39;div_mask&#39;: 1} -&gt; Warp -- {&#39;magnitude&#39;: 0.2, &#39;p&#39;: 1.0, &#39;draw_x&#39;: None, &#39;draw_y&#39;: None, &#39;size&#39;: None, &#39;mode&#39;: &#39;bilinear&#39;, &#39;pad_mode&#39;: &#39;reflection&#39;, &#39;batch&#39;: False, &#39;align_corners&#39;: True, &#39;mode_mask&#39;: &#39;nearest&#39;} -&gt; RandomResizedCropGPU -- {&#39;size&#39;: None, &#39;min_scale&#39;: 0.8, &#39;ratio&#39;: (1, 1), &#39;mode&#39;: &#39;bilinear&#39;, &#39;valid_scale&#39;: 1.0, &#39;p&#39;: 1.0} -&gt; Brightness -- {&#39;max_lighting&#39;: 0.2, &#39;p&#39;: 1.0, &#39;draw&#39;: None, &#39;batch&#39;: False}

Building one batch
Applying item_tfms to the first sample:
  Pipeline: Resize -- {&#39;size&#39;: (28, 28), &#39;method&#39;: &#39;crop&#39;, &#39;pad_mode&#39;: &#39;reflection&#39;, &#39;resamples&#39;: (2, 0), &#39;p&#39;: 1.0} -&gt; ToTensor
    starting from
      (PILImage mode=RGB size=28x28, TensorCategory(1))
    applying Resize -- {&#39;size&#39;: (28, 28), &#39;method&#39;: &#39;crop&#39;, &#39;pad_mode&#39;: &#39;reflection&#39;, &#39;resamples&#39;: (2, 0), &#39;p&#39;: 1.0} gives
      (PILImage mode=RGB size=28x28, TensorCategory(1))
    applying ToTensor gives
      (TensorImage of size 3x28x28, TensorCategory(1))

Adding the next 3 samples

No before_batch transform to apply

Collating items in a batch

Applying batch_tfms to the batch built
  Pipeline: IntToFloatTensor -- {&#39;div&#39;: 255.0, &#39;div_mask&#39;: 1} -&gt; Warp -- {&#39;magnitude&#39;: 0.2, &#39;p&#39;: 1.0, &#39;draw_x&#39;: None, &#39;draw_y&#39;: None, &#39;size&#39;: None, &#39;mode&#39;: &#39;bilinear&#39;, &#39;pad_mode&#39;: &#39;reflection&#39;, &#39;batch&#39;: False, &#39;align_corners&#39;: True, &#39;mode_mask&#39;: &#39;nearest&#39;} -&gt; RandomResizedCropGPU -- {&#39;size&#39;: None, &#39;min_scale&#39;: 0.8, &#39;ratio&#39;: (1, 1), &#39;mode&#39;: &#39;bilinear&#39;, &#39;valid_scale&#39;: 1.0, &#39;p&#39;: 1.0} -&gt; Brightness -- {&#39;max_lighting&#39;: 0.2, &#39;p&#39;: 1.0, &#39;draw&#39;: None, &#39;batch&#39;: False}
    starting from
      (TensorImage of size 4x3x28x28, TensorCategory([1, 1, 1, 1]))
    applying IntToFloatTensor -- {&#39;div&#39;: 255.0, &#39;div_mask&#39;: 1} gives
      (TensorImage of size 4x3x28x28, TensorCategory([1, 1, 1, 1]))
    applying Warp -- {&#39;magnitude&#39;: 0.2, &#39;p&#39;: 1.0, &#39;draw_x&#39;: None, &#39;draw_y&#39;: None, &#39;size&#39;: None, &#39;mode&#39;: &#39;bilinear&#39;, &#39;pad_mode&#39;: &#39;reflection&#39;, &#39;batch&#39;: False, &#39;align_corners&#39;: True, &#39;mode_mask&#39;: &#39;nearest&#39;} gives
      (TensorImage of size 4x3x28x28, TensorCategory([1, 1, 1, 1]))
    applying RandomResizedCropGPU -- {&#39;size&#39;: None, &#39;min_scale&#39;: 0.8, &#39;ratio&#39;: (1, 1), &#39;mode&#39;: &#39;bilinear&#39;, &#39;valid_scale&#39;: 1.0, &#39;p&#39;: 1.0} gives
      (TensorImage of size 4x3x26x26, TensorCategory([1, 1, 1, 1]))
    applying Brightness -- {&#39;max_lighting&#39;: 0.2, &#39;p&#39;: 1.0, &#39;draw&#39;: None, &#39;batch&#39;: False} gives
      (TensorImage of size 4x3x26x26, TensorCategory([1, 1, 1, 1]))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create the dataloader</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">datablock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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ttBxBwAAgAjRAAAAECEaAAAAIkQDAABAhGgAAACIUDjWlG8IIbf9jRG58sorXfa73/3OZW3btpX16h3Wc+bMyfjrq4naEILL1Pvpq0qSJP4Eqlns13Dnzp1ddu+998pj1bpYtU467TPj7/7u71z27rvvHu8Ua7SacA2bZXcdt27d2mVqzfONN94o69VnkVphnram+s0333TZxIkTXZb2RJU6V3VtderUSdarde+vv/66y/7zP/9T1s+fP99lBw8elMcWirTrmDsAAABEiAYAAIAI0QAAABAhGgAAACLEEOAJ8sEHH7isb9++Llu3bmtuWyAAABPISURBVJ2sP/vss122bdu23E8sj2rCAFVM17AafvrOd77jsp/85CeyXq1QPXDggMvShghr49rfmnANm+V+Hashvt69e8tjBwwY4LLLL7/cZSUlJbK+ffv2LjvllFOOd4rHdPToUZelXVuTJk1y2WOPPeYytbI47WsVOoYAAQDAF2gAAACIEA0AAAARogEAACBCehUTstajRw+XVVRUuOyJJ56Q9YU+8Ifq07BhQ5lfc801Lrvjjjtc1q5dO1mvtp3df//9LlMbLs2qd8skslNeXu4y9d77tHz58uUuUxsHzcx69erlspEjR7osbYiwWbNmLlPbBZ9//nlZ/8knn7hs165dLquNw37Z4g4AAAARogEAACBCNAAAAESIBgAAgAjRAAAAECFWAWdp+PDhMp8+fbrLZs2a5bJrr71W1m/dujW3E6uBasIa1dp4Dffr10/mair6tNNOc1na7/kZM2a4TL0zXk1Z11Y14Ro2q53Xca7U6msznkZRWAUMAAC+QAMAAECEaAAAAIgQDQAAABFiFXCWevbsKXP1burVq1e7rDYO+6F63X777TLv06dPRvXz5s2T+bhx41wW08AfCgvDfrnjDgAAABGiAQAAIEI0AAAARIgGAACACDEEmKUhQ4bIfMuWLS574403qvp0UMv17t3bZaNGjZLH1qtXz2X79+932cSJE2X9pk2bsjw7AIWMOwAAAESIBgAAgAjRAAAAECEaAAAAIkQDAABAhHgK4BjU+6bTVvlu377dZUxVI1elpaUuu/baa+WxO3fudNm2bdtcVlZWlvuJASh43AEAACBCNAAAAESIBgAAgAjRAAAAEKGQJEm+zwEAAFQz7gAAABAhGgAAACJEAwAAQIRo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b98+WY/qo36tzcxat27tstNPP91laq2omdnOnTtdpn69075+s2bNXFa/fn2XpQ2MqnWrW7dudVnjxo1lvVoBq35fpa3yVau31RDjjBkzZP38+fNdVlFRIY9F1VGfcc8//7zLxo8fL+vVdTRmzBiXXXzxxbJ+5MiRLlPXbJcuXWS9+n346quvumzTpk2yPibcAQAAIEI0AAAARIgGAACACNEAAAAQoYIbAjzllFNkftddd7lMDSCpLC1XA1xvvvmmrH/llVdctn//fnks8qt58+Yyv/zyy132yCOPuCztGlq0aJHL1KBRgwYNZL0arisuLnZZ2nvYV61a5TI1qNWjRw9Zr4aqzj77bJelDRGuXLnSZdOnT3dZ2hCgOn/UDGp4uqysTB6rcvX5uHHjRlk/evRol3Xq1MllS5culfWTJ092mdoumDbQHRPuAAAAECEaAAAAIkQDAABAhGgAAACIEA0AAAARKrinANSaRzOzHTt2uEytdk1717Oa2D948GDG9WrlKmqmtKcATjrpJJetWLHCZX379pX1aopfTdanrQJW1+DatWtdtnnzZllfXl7uMvUki5rWNzNbv369y/7617+6LG36W01Vq7XFu3fvlvWovbZt2+aySZMmyWPT8i9L+32cJInL1JpsdVxsuAMAAECEaAAAAIgQDQAAABGiAQAAIEIFNwQ4d+5cmb/00ksu+973vueytPWPma5xXbNmzfFOETVc2hCburbU0Gm7du1O+DmZ6YG9zz77zGVpQ3RqCHDDhg05nZMankpbcZ02IAtUBYZJc8cdAAAAIkQDAABAhGgAAACIEA0AAAARCsfahhRCKJhVSaeeeqrLbr75Zpep96ubmT355JMumzNnjstKSkpkPZsAvSRJQr7PoZCuYdQ8NeEaNuM6Rm7SrmPuAAAAECEaAAAAIkQDAABAhGgAAACIEA0AAAARKrhVwGnvUm/Tpo3L1GrVtFXCae9I/zKm/QEAtQF3AAAAiBANAAAAEaIBAAAgQjQAAABE6JirgAEAQO3EHQAAACJEAwAAQIRoAAAAiBANAAAAEaIBAAAgQjQAAABE6P8A9PqGBEDtaHUAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create a Fastai CNN Learner</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span> <span class="o">=</span> <span class="n">cnn_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">resnet18</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
                      
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Set Learner to XLA mode
This will setup the learner to use the XLA Device</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">to_xla</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;fastai.learner.Learner at 0x7fc75a5a8090&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the <code>lr_find</code> works</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.02089296132326126, lr_steep=0.0030199517495930195)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Run one cycle training.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">lr_max</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span><span class="mf">0.02</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.896238</td>
      <td>1.876374</td>
      <td>0.505007</td>
      <td>00:51</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.725275</td>
      <td>1.018629</td>
      <td>0.532189</td>
      <td>00:13</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.614300</td>
      <td>3.292356</td>
      <td>0.513591</td>
      <td>00:03</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.549166</td>
      <td>2.262487</td>
      <td>0.580830</td>
      <td>00:03</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.535161</td>
      <td>1.760773</td>
      <td>0.660944</td>
      <td>00:03</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Further fine-tuning</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="mf">7e-4</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.280359</td>
      <td>0.992468</td>
      <td>0.688126</td>
      <td>00:12</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.315132</td>
      <td>1.013533</td>
      <td>0.712446</td>
      <td>00:03</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.306187</td>
      <td>0.745202</td>
      <td>0.711016</td>
      <td>00:03</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.282278</td>
      <td>0.701246</td>
      <td>0.736767</td>
      <td>00:03</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.288474</td>
      <td>0.854370</td>
      <td>0.711016</td>
      <td>00:03</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Model params are using TPU</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">one_param</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">device</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>device(type=&#39;xla&#39;, index=1)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Dataloader device is set to None (as it is the device mover transform that moves the input to the TPU)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Plot loss seems to be working fine.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Performance-troubleshooting">Performance troubleshooting<a class="anchor-link" href="#Performance-troubleshooting"> </a></h2><p>To check if your model is hiting an <code>aten operation</code> (an operation that is not handled by accelerator device and returned to CPU for default implementation) you can check it with ands then you can report to pytorch xla team.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai_xla_extensions.utils</span> <span class="kn">import</span> <span class="n">print_aten_ops</span>

<span class="n">print_aten_ops</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>needs lowering: Counter: aten::adaptive_max_pool2d
  Value: 311
needs lowering: Counter: aten::adaptive_max_pool2d_backward
  Value: 201
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Samples">Samples<a class="anchor-link" href="#Samples"> </a></h2><p>Other examples of fastai notebooks using the fastai_xla_extensions package are also available here:</p>
<ul>
<li><a href="https://github.com/butchland/fastai_xla_extensions/blob/master/samples/fastai-multi-core-tpu-training-sample.ipynb">Vision (Multiple TPU Core) - CIFAR</a> <a href="https://colab.research.google.com/github/butchland/fastai_xla_extensions/blob/master/samples/fastai-multi-core-tpu-training-sample.ipynb"><img src="https://camo.githubusercontent.com/52feade06f2fecbf006889a904d221e6a730c194/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667" alt=""></a></li>
<li><p><a href="https://github.com/butchland/fastai_xla_extensions/blob/master/samples/fastai-multi-core-tpu-training-sample2.ipynb">Vision (Multiple TPU Core) - Multi Label</a> <a href="https://colab.research.google.com/github/butchland/fastai_xla_extensions/blob/master/samples/fastai-multi-core-tpu-training-sample2.ipynb"><img src="https://camo.githubusercontent.com/52feade06f2fecbf006889a904d221e6a730c194/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667" alt=""></a></p>
</li>
<li><p><a href="https://github.com/butchland/fastai_xla_extensions/blob/master/samples/test_fast_tpu_pets.ipynb">Vision (Multiple TPU Core) - Pets</a> <a href="https://colab.research.google.com/github/butchland/fastai_xla_extensions/blob/master/samples/test_fast_tpu_pets.ipynb"><img src="https://camo.githubusercontent.com/52feade06f2fecbf006889a904d221e6a730c194/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667" alt=""></a></p>
</li>
<li><p><a href="https://github.com/butchland/fastai_xla_extensions/blob/master/samples/MNIST_TPU_demo.ipynb">Vision (Single Core TPU)</a> <a href="https://colab.research.google.com/github/butchland/fastai_xla_extensions/blob/master/samples/MNIST_TPU_demo.ipynb"><img src="https://camo.githubusercontent.com/52feade06f2fecbf006889a904d221e6a730c194/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667" alt=""></a></p>
</li>
<li><p><a href="https://github.com/butchland/fastai_xla_extensions/blob/master/samples/MovieLensCollaborativeFilteringTPU.ipynb">Collaborative Filtering (Single Core TPU)</a> <a href="https://colab.research.google.com/github/butchland/fastai_xla_extensions/blob/master/samples/MovieLensCollaborativeFilteringTPU.ipynb"><img src="https://camo.githubusercontent.com/52feade06f2fecbf006889a904d221e6a730c194/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667" alt=""></a></p>
</li>
<li><p><a href="https://github.com/butchland/fastai_xla_extensions/blob/master/samples/TabularTrainingTPUdemo.ipynb">Tabular (Single Core TPU)</a> <a href="https://colab.research.google.com/github/butchland/fastai_xla_extensions/blob/master/samples/TabularTrainingTPUdemo.ipynb"><img src="https://camo.githubusercontent.com/52feade06f2fecbf006889a904d221e6a730c194/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667" alt=""></a></p>
</li>
</ul>
<p>More samples will be added in the future as we fix issues and implement more capabilities.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Status">Status<a class="anchor-link" href="#Status"> </a></h2><p>The fastai XLA extensions library is still in early development phase but is getting close to a 1.0 release.</p>
<p>The Multi Core TPU mode has been well tested on vision tasks (Classification) but the other modules (Tabular, Collab Filtering, and Text) have not.</p>
<p>If you use the package and encounter issues, please file bugs and issues encountered in the project's issue tracker.</p>
<p>Feel free to suggest enhancements or feature requests. (Though they might not necessarily be addressed any time soon).</p>
<p>If you wish to contribute to the project, fork it and make pull request.</p>
<p>This project uses <a href="https://nbdev.fast.ai/">nbdev</a> -- a jupyter notebook first development environment and is being developed on <a href="https://colab.research.google.com">Colab</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Development-Setup">Development Setup<a class="anchor-link" href="#Development-Setup"> </a></h2><p>see <a href="https://butchland.github.io/fastai_xla_extensions/dev_setup">this note on how to setup your environment for development</a></p>

</div>
</div>
</div>
</div>
 

<script type="application/vnd.jupyter.widget-state+json">
{"890a52fe44e94ee8a8bb2ac88626fcfa": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_view_name": "HBoxView", "_dom_classes": [], "_model_name": "HBoxModel", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.5.0", "box_style": "", "layout": "IPY_MODEL_ef63f44a82ad48baae58767cf6a24650", "_model_module": "@jupyter-widgets/controls", "children": ["IPY_MODEL_cb4d0312a9044a99aa4f26956fc2fb12", "IPY_MODEL_411f1324a17c40cb8a7cd30600198936"]}}, "ef63f44a82ad48baae58767cf6a24650": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "cb4d0312a9044a99aa4f26956fc2fb12": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "state": {"_view_name": "ProgressView", "style": "IPY_MODEL_ea3474e90ca643c7a47bee95c1e9dfea", "_dom_classes": [], "description": "100%", "_model_name": "FloatProgressModel", "bar_style": "success", "max": 46827520, "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": 46827520, "_view_count": null, "_view_module_version": "1.5.0", "orientation": "horizontal", "min": 0, "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_36e72c6c3c0c4b27b39ab5f506985eba"}}, "411f1324a17c40cb8a7cd30600198936": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_view_name": "HTMLView", "style": "IPY_MODEL_2781da5e70544d84b62d5ebbc87bcb3a", "_dom_classes": [], "description": "", "_model_name": "HTMLModel", "placeholder": "\u200b", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": " 44.7M/44.7M [01:24&lt;00:00, 557kB/s]", "_view_count": null, "_view_module_version": "1.5.0", "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_596161e99c30401cb1d28fb9f3137baf"}}, "ea3474e90ca643c7a47bee95c1e9dfea": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_view_name": "StyleView", "_model_name": "ProgressStyleModel", "description_width": "initial", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "bar_color": null, "_model_module": "@jupyter-widgets/controls"}}, "36e72c6c3c0c4b27b39ab5f506985eba": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "2781da5e70544d84b62d5ebbc87bcb3a": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_view_name": "StyleView", "_model_name": "DescriptionStyleModel", "description_width": "", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "_model_module": "@jupyter-widgets/controls"}}, "596161e99c30401cb1d28fb9f3137baf": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}}
</script>

